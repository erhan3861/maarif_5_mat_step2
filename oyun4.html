<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bilin√ßli Market - G√∂rev 4</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Nunito:wght@700&display=swap" rel="stylesheet">
    <style>
        /* --- GENEL AYARLAR (MARKET TEMASI) --- */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
            background-color: #6c5ce7;
            /* Market Rafƒ± G√∂r√ºn√ºm√º */
            background-image: 
                linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #333;
            overflow: hidden;
        }

        /* --- √úST BUTONLAR --- */
        .top-bar {
            position: absolute; top: 20px; width: 95%;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 50; pointer-events: none;
        }
        .right-group { display: flex; gap: 10px; pointer-events: auto; }
        
        .top-btn {
            padding: 8px 20px; border-radius: 8px; border: none;
            font-family: 'Nunito', sans-serif; font-weight: 800; font-size: 0.9rem;
            text-decoration: none; cursor: pointer; transition: all 0.2s;
            display: flex; align-items: center; justify-content: center;
            pointer-events: auto; box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        .home-btn { background: #fdcb6e; color: #2d3436; border: 2px solid #e17055; }
        .code-btn { background: #00cec9; color: #2d3436; border: 2px solid #00b894; }
        .full-btn { background: #636e72; color: white; border: 2px solid #2d3436; }

        .top-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 0 rgba(0,0,0,0.2); }
        .top-btn:active { transform: translateY(2px); box-shadow: 0 2px 0 rgba(0,0,0,0.2); }

        /* --- OYUN ALANI (KASA & Fƒ∞≈û) --- */
        .market-layout {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            width: 95%;
            max-width: 1000px;
            height: 80vh;
        }

        /* Yazar Kasa */
        .register-machine {
            background: #2d3436;
            padding: 20px;
            border-radius: 20px;
            border-bottom: 10px solid #1e272e;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            width: 350px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .brand-logo { color: #b2bec3; font-size: 0.8rem; letter-spacing: 2px; margin-bottom: 10px; }

        /* Dijital Ekran */
        .display-screen {
            background: #000;
            color: #00ff00;
            font-family: 'Share Tech Mono', monospace;
            width: 90%;
            height: 60px;
            border: 4px solid #555;
            border-radius: 5px;
            font-size: 2rem;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 15px;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.7);
            box-shadow: inset 0 0 10px rgba(0,0,0,0.8);
        }

        /* √úr√ºn Bandƒ± (Bilgi Ekranƒ±) */
        .product-info {
            background: #dfe6e9;
            width: 90%;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px dashed #b2bec3;
        }
        .p-name { font-size: 1.2rem; font-weight: bold; color: #2d3436; display: block; }
        .p-price { font-size: 1.1rem; color: #d63031; }
        .p-tax { color: #0984e3; font-weight: bold; }

        /* Tu≈ü Takƒ±mƒ± */
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            width: 90%;
        }

        .key {
            background: #636e72;
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 0 #2d3436;
            transition: transform 0.1s;
            font-family: 'Share Tech Mono', monospace;
        }
        .key:active { transform: translateY(3px); box-shadow: 0 1px 0 #2d3436; }
        .key-clear { background: #d63031; box-shadow: 0 4px 0 #c0392b; }
        .key-enter { background: #00b894; grid-column: span 3; box-shadow: 0 4px 0 #009476; color: #fff; font-weight: bold; }

        /* Fi≈ü (Receipt) Alanƒ± */
        .receipt-area {
            background: #fff;
            width: 300px;
            height: 500px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1));
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Fi≈üin tƒ±rtƒ±klƒ± tepesi */
        .receipt-area::before {
            content: "";
            position: absolute; top: -10px; left: 0; width: 100%; height: 20px;
            background: linear-gradient(135deg, transparent 10px, #fff 10px), linear-gradient(225deg, transparent 10px, #fff 10px);
            background-size: 20px 20px;
            background-position: 0 10px;
            background-repeat: repeat-x;
        }

        .receipt-header {
            text-align: center;
            padding: 30px 20px 10px 20px;
            border-bottom: 1px dashed #aaa;
            font-family: 'Share Tech Mono', monospace;
            color: #555;
        }

        .receipt-body {
            flex: 1;
            padding: 20px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem;
            color: #333;
            overflow-y: auto;
        }

        .receipt-line {
            display: flex; justify-content: space-between; margin-bottom: 8px;
            animation: printLine 0.5s ease;
        }
        
        @keyframes printLine { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Feedback Overlay */
        .feedback-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none;
            flex-direction: column; align-items: center; justify-content: center;
            z-index: 100; color: white; text-align: center; border-radius: 15px;
        }

        .next-btn {
            margin-top: 20px; padding: 12px 30px; background: #00cec9; color: #2d3436;
            border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1.1rem;
        }

        /* ≈ûifre Kartƒ± */
        .secret-card {
            border: 2px dashed #00cec9; padding: 20px; border-radius: 10px; 
            background: rgba(0, 206, 201, 0.1); margin-top: 15px; display: none;
        }
        .secret-letter { font-size: 3rem; color: #00cec9; font-weight: bold; display: block; }

        /* KODLAMA MODAL */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); z-index: 1000;
            display: none; align-items: center; justify-content: center;
        }
        .modal-card {
            background: #fff; padding: 30px; border-radius: 15px; max-width: 450px;
            text-align: center; color: #333; position: relative; border-top: 5px solid #00cec9;
        }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer; border: none; background: none; }
        .action-link { display: block; background: #333; color: white; padding: 12px; border-radius: 8px; text-decoration: none; margin: 10px 0; font-weight: bold; }

        @media (max-width: 800px) {
            .market-layout { flex-direction: column; height: auto; padding: 20px 0; }
            .receipt-area { height: 200px; width: 350px; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <a href="index.html" class="top-btn home-btn">‚åÇ ANA MEN√ú</a>
        <div class="right-group">
            <button onclick="openCodeModal()" class="top-btn code-btn">‚å® KODLA</button>
            <button onclick="toggleFullScreen()" id="full-btn" class="top-btn full-btn">‚õ∂ TAM EKRAN</button>
        </div>
    </div>

    <div class="market-layout">
        <div class="register-machine">
            <div class="brand-logo">MAARƒ∞F POS v2.0</div>
            
            <div class="display-screen" id="screen">_</div>

            <div class="product-info">
                <span style="font-size:0.8rem; color:#636e72;">√úR√úN Bƒ∞LGƒ∞Sƒ∞ (<span id="level-idx">1/5</span>)</span>
                <span class="p-name" id="p-name">S√úT</span>
                <span class="p-price" id="p-price">Fƒ∞YAT: 50 TL</span>
                <div style="margin-top:5px; border-top:1px dashed #b2bec3; padding-top:5px;">
                    HESAPLA: <span class="p-tax" id="p-tax">Fiyatƒ±n 1/10'u (KDV)</span>
                </div>
            </div>

            <div class="keypad">
                <button class="key" onclick="pressKey(7)">7</button>
                <button class="key" onclick="pressKey(8)">8</button>
                <button class="key" onclick="pressKey(9)">9</button>
                <button class="key" onclick="pressKey(4)">4</button>
                <button class="key" onclick="pressKey(5)">5</button>
                <button class="key" onclick="pressKey(6)">6</button>
                <button class="key" onclick="pressKey(1)">1</button>
                <button class="key" onclick="pressKey(2)">2</button>
                <button class="key" onclick="pressKey(3)">3</button>
                <button class="key key-clear" onclick="clearScreen()">C</button>
                <button class="key" onclick="pressKey(0)">0</button>
                <button class="key" onclick="pressKey('.')">.</button>
                <button class="key key-enter" onclick="checkAnswer()">Gƒ∞Rƒ∞≈û / ONAYLA</button>
            </div>
        </div>

        <div class="receipt-area">
            <div class="receipt-header">
                <h3>Bƒ∞Lƒ∞N√áLƒ∞ MARKET</h3>
                <p>Tarih: Bug√ºn</p>
                <p>Fi≈ü No: 00513</p>
            </div>
            <div class="receipt-body" id="receipt-body">
                </div>
        </div>
    </div>

    <div class="feedback-overlay" id="feedback">
        <h1 style="font-size: 4rem; margin:0;">üßæ</h1>
        <h2 style="color:#00cec9;" id="fb-title">DOƒûRU HESAP!</h2>
        <p id="fb-msg">KDV tutarƒ±nƒ± doƒüru hesapladƒ±n. Fi≈ü kesiliyor...</p>
        
        <div class="secret-card" id="secret-card">
            ≈ûƒ∞FRE PAR√áASI:
            <span class="secret-letter">K</span>
        </div>

        <button class="next-btn" id="next-btn" onclick="nextLevel()">SIRADAKƒ∞ M√ú≈ûTERƒ∞ ‚ñ∂</button>
    </div>

    <div class="modal-overlay" id="codeModal">
        <div class="modal-card">
            <button class="close-btn" onclick="closeCodeModal()">√ó</button>
            <h2 style="color:#00cec9;">üí≥ Kasa Yazƒ±lƒ±mƒ±</h2>
            <p>Vergi oranlarƒ±nƒ± ve fiyatlarƒ± kodlarla deƒüi≈ütir!</p>
            <a href="https://github.com/erhan3861/maarif_5_mat_1/blob/main/oyun4.html" target="_blank" class="action-link" style="background:#2d3436;">üêô GitHub Kaynak Kodu</a>
            <a href="https://app.talent14.com/codeEditor" target="_blank" class="action-link" style="background:#00cec9;">‚ú® Talent14 Edit√∂r√º</a>
        </div>
    </div>

    <script>
        // --- TAM EKRAN ---
        function toggleFullScreen() {
            const btn = document.getElementById('full-btn');
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                btn.innerHTML = "‚õ∂ K√ú√á√úLT";
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    btn.innerHTML = "‚õ∂ TAM EKRAN";
                }
            }
        }

        // --- OYUN VERƒ∞LERƒ∞ ---
        const levels = [
            { name: "EKMEK", price: 20, desc: "Fiyatƒ±n 1/10'u (KDV)", answer: 2 }, // 20 / 10 = 2
            { name: "√áƒ∞KOLATA", price: 50, desc: "Fiyatƒ±n %10'u (KDV)", answer: 5 }, // 50 * 0.10 = 5
            { name: "DETERJAN", price: 200, desc: "Fiyatƒ±n %20'si (KDV)", answer: 40 }, // 200 * 0.20 = 40
            { name: "Kƒ∞TAP", price: 100, desc: "Fiyatƒ±n 1/100'√º (Vergi)", answer: 1 }, // 100 / 100 = 1
            { name: "OYUNCAK", price: 500, desc: "Fiyatƒ±n yarƒ±sƒ± (1/2) (ƒ∞ndirim)", answer: 250 } // 500 / 2 = 250
        ];

        let currentIdx = 0;
        let currentInput = "";

        window.onload = loadLevel;

        function loadLevel() {
            if (currentIdx >= levels.length) {
                showFinalSecret();
                return;
            }

            const data = levels[currentIdx];
            
            // UI G√ºncelle
            document.getElementById('level-idx').innerText = (currentIdx + 1) + "/" + levels.length;
            document.getElementById('p-name').innerText = data.name;
            document.getElementById('p-price').innerText = `Fƒ∞YAT: ${data.price} TL`;
            document.getElementById('p-tax').innerText = data.desc;
            
            clearScreen();
            document.getElementById('feedback').style.display = 'none';
        }

        function pressKey(key) {
            if (currentInput.length < 6) { // Max karakter
                currentInput += key;
                updateScreen();
            }
        }

        function clearScreen() {
            currentInput = "";
            updateScreen();
        }

        function updateScreen() {
            const screen = document.getElementById('screen');
            screen.innerText = currentInput === "" ? "_" : currentInput;
        }

        function checkAnswer() {
            const val = parseFloat(currentInput);
            const data = levels[currentIdx];

            if (val === data.answer) {
                // Doƒüru
                printReceipt(data.name, data.price, val);
                showFeedback(true);
            } else {
                // Yanlƒ±≈ü
                alert("Hatalƒ± Tutar! L√ºtfen hesaplamayƒ± kontrol et.");
                clearScreen();
            }
        }

        function printReceipt(name, price, tax) {
            const body = document.getElementById('receipt-body');
            const line = document.createElement('div');
            line.className = 'receipt-line';
            line.innerHTML = `<span>${name}</span> <span>${price.toFixed(2)} TL</span>`;
            
            const taxLine = document.createElement('div');
            taxLine.className = 'receipt-line';
            taxLine.style.color = "#999";
            taxLine.style.fontSize = "0.8rem";
            taxLine.innerHTML = `<span>+ Vergi/ƒ∞ndirim</span> <span>${tax.toFixed(2)} TL</span>`;

            body.appendChild(line);
            body.appendChild(taxLine);
            
            // Otomatik scroll
            body.scrollTop = body.scrollHeight;
        }

        function showFeedback(isSuccess) {
            const fb = document.getElementById('feedback');
            const title = document.getElementById('fb-title');
            const msg = document.getElementById('fb-msg');
            const nextBtn = document.getElementById('next-btn');

            fb.style.display = 'flex';

            if (currentIdx === levels.length - 1) {
                title.innerText = "KASA KAPANDI!";
                msg.innerText = "G√ºn√ºn kahramanƒ± sensin. ƒ∞≈üte ≈üifre par√ßan:";
                document.getElementById('secret-card').style.display = 'block';
                nextBtn.innerText = "ANA MEN√úYE D√ñN";
                nextBtn.onclick = () => window.location.href = 'index.html';
            } else {
                title.innerText = "ƒ∞≈ûLEM TAMAM";
                msg.innerText = "Fi≈ü ba≈üarƒ±yla kesildi.";
                document.getElementById('secret-card').style.display = 'none';
                nextBtn.innerText = "SIRADAKƒ∞ √úR√úN ‚ñ∂";
                nextBtn.onclick = nextLevel;
            }
        }

        function nextLevel() {
            currentIdx++;
            loadLevel();
        }

        function showFinalSecret() {
            // G√ºvenlik
        }

        // --- KODLAMA MODAL ---
        function openCodeModal() { document.getElementById('codeModal').style.display = 'flex'; }
        function closeCodeModal() { document.getElementById('codeModal').style.display = 'none'; }
        document.getElementById('codeModal').addEventListener('click', function(e) {
            if(e.target === this) closeCodeModal();
        });

    </script>
</body>
</html>